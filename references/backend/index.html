
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../sections/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>App backend - EMBA report docs.</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#app.backend.data_extractors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EMBA report docs." class="md-header__button md-logo" aria-label="EMBA report docs." data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EMBA report docs.
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              App backend
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Docs

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EMBA report docs." class="md-nav__button md-logo" aria-label="EMBA report docs." data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EMBA report docs.
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    App backend
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    App backend
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#app.backend.data_extractors" class="md-nav__link">
    <span class="md-ellipsis">
      data_extractors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="data_extractors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor" class="md-nav__link">
    <span class="md-ellipsis">
      ExitEmbaExtractor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExitEmbaExtractor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.calulate_csi" class="md-nav__link">
    <span class="md-ellipsis">
      calulate_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_age_distr" class="md-nav__link">
    <span class="md-ellipsis">
      get_age_distr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_basic_csi" class="md-nav__link">
    <span class="md-ellipsis">
      get_basic_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_collaborators" class="md-nav__link">
    <span class="md-ellipsis">
      get_collaborators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_design_csi" class="md-nav__link">
    <span class="md-ellipsis">
      get_design_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_group_csi" class="md-nav__link">
    <span class="md-ellipsis">
      get_group_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_industry_distr" class="md-nav__link">
    <span class="md-ellipsis">
      get_industry_distr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_industry_nps" class="md-nav__link">
    <span class="md-ellipsis">
      get_industry_nps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_intern_modules_csi" class="md-nav__link">
    <span class="md-ellipsis">
      get_intern_modules_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_job_distr" class="md-nav__link">
    <span class="md-ellipsis">
      get_job_distr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_overall_csi" class="md-nav__link">
    <span class="md-ellipsis">
      get_overall_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_pilos" class="md-nav__link">
    <span class="md-ellipsis">
      get_pilos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_programs_nps" class="md-nav__link">
    <span class="md-ellipsis">
      get_programs_nps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_support_csi" class="md-nav__link">
    <span class="md-ellipsis">
      get_support_csi
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.data_extractors.ExitEmbaExtractor.get_top_lectors" class="md-nav__link">
    <span class="md-ellipsis">
      get_top_lectors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.backend.plotter" class="md-nav__link">
    <span class="md-ellipsis">
      plotter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plotter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app.backend.plotter.PlotGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      PlotGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlotGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app.backend.plotter.PlotGenerator.make_boxplot" class="md-nav__link">
    <span class="md-ellipsis">
      make_boxplot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.plotter.PlotGenerator.make_hbarplot" class="md-nav__link">
    <span class="md-ellipsis">
      make_hbarplot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.plotter.PlotGenerator.make_nps_barplot" class="md-nav__link">
    <span class="md-ellipsis">
      make_nps_barplot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.plotter.PlotGenerator.make_piechart" class="md-nav__link">
    <span class="md-ellipsis">
      make_piechart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#app.backend.plotter.PlotGenerator.make_stacked_barplot" class="md-nav__link">
    <span class="md-ellipsis">
      make_stacked_barplot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#app.backend.raw_data_processor" class="md-nav__link">
    <span class="md-ellipsis">
      raw_data_processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="raw_data_processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#app.backend.raw_data_processor.process_exit_survey" class="md-nav__link">
    <span class="md-ellipsis">
      process_exit_survey
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    App sections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../main_page/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    App main page
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>App backend</h1>

<div class="doc doc-object doc-module">



<h2 id="app.backend.data_extractors" class="doc doc-heading">
            <code>app.backend.data_extractors</code>


</h2>

    <div class="doc doc-contents first">

        <p>Add classes of data extractors for different surveys/tables/programs here.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="app.backend.data_extractors.ExitEmbaExtractor" class="doc doc-heading">
            <code>ExitEmbaExtractor</code>


</h3>


    <div class="doc doc-contents ">


        <p>Extracts and organizes data from an Excel table for plotting purposes.
This class reads a structured .xlsx file and provides methods to extract
and preprocess data for generating various analytical plots (e.g., distribution charts, trends)
and calculating some metrics.</p>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_age_distr(age_Qind=15) (app.backend.data_extractors.ExitEmbaExtractor.get_age_distr)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_age_distr">get_age_distr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns respondent counts by age group.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_industry_distr(industry_Qind=14) (app.backend.data_extractors.ExitEmbaExtractor.get_industry_distr)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_industry_distr">get_industry_distr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns distribution of respondents by industry.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_job_distr(job_Qinds=13) (app.backend.data_extractors.ExitEmbaExtractor.get_job_distr)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_job_distr">get_job_distr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns counts of selected job functions.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_overall_csi(csi_Qinds=[2, 3, 5, 7, 8, 9]) (app.backend.data_extractors.ExitEmbaExtractor.get_overall_csi)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_overall_csi">get_overall_csi</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extracts average CSI scores for key program components.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="calulate_csi(csi_data) (app.backend.data_extractors.ExitEmbaExtractor.calulate_csi)" href="#app.backend.data_extractors.ExitEmbaExtractor.calulate_csi">calulate_csi</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Computes overall CSI score from component data.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_group_csi(csi_Qind=9) (app.backend.data_extractors.ExitEmbaExtractor.get_group_csi)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_group_csi">get_group_csi</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extract CSI data for various program evaluation blocks.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_pilos(nps_Qind=3) (app.backend.data_extractors.ExitEmbaExtractor.get_pilos)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_pilos">get_pilos</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Aggregates counts of ratings for program learning outcomes.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_top_lectors(lectors_Qind=6) (app.backend.data_extractors.ExitEmbaExtractor.get_top_lectors)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_top_lectors">get_top_lectors</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Counts and ranks lecturer selections.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="get_collaborators(collab_Qind=11) (app.backend.data_extractors.ExitEmbaExtractor.get_collaborators)" href="#app.backend.data_extractors.ExitEmbaExtractor.get_collaborators">get_collaborators</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Summarizes alumni collaboration preferences.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="app.backend.data_extractors.ExitEmbaExtractor.get_programs_nps, get_industry_nps">get_programs_nps, get_industry_nps</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return NPS data for programs and industries.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ExitEmbaExtractor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts and organizes data from an Excel table for plotting purposes.</span>
<span class="sd">    This class reads a structured .xlsx file and provides methods to extract</span>
<span class="sd">    and preprocess data for generating various analytical plots (e.g., distribution charts, trends)</span>
<span class="sd">    and calculating some metrics.</span>

<span class="sd">    Methods:</span>
<span class="sd">        get_age_distr: Returns respondent counts by age group.</span>
<span class="sd">        get_industry_distr: Returns distribution of respondents by industry.</span>
<span class="sd">        get_job_distr: Returns counts of selected job functions.</span>
<span class="sd">        get_overall_csi: Extracts average CSI scores for key program components.</span>
<span class="sd">        calulate_csi: Computes overall CSI score from component data.</span>
<span class="sd">        get_basic_csi, get_design_csi, get_intern_modules_csi, get_support_csi,</span>
<span class="sd">        get_group_csi: Extract CSI data for various program evaluation blocks.</span>
<span class="sd">        get_pilos: Aggregates counts of ratings for program learning outcomes.</span>
<span class="sd">        get_top_lectors: Counts and ranks lecturer selections.</span>
<span class="sd">        get_collaborators: Summarizes alumni collaboration preferences.</span>
<span class="sd">        get_programs_nps, get_industry_nps: Return NPS data for programs and industries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">IO</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize an extractor object</span>

<span class="sd">        Args:</span>
<span class="sd">            table_path (str | IO): string with a path to a structured Excel tables or a file-like object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">table_path</span><span class="p">)</span>

    <span class="c1"># below are methods for extracting data, used in piecharts</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_age_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the distribution of respondents by age group.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            age_Qind (int, optional): The index of the question containing age group information. Defaults to 15.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, int]: A dictionary mapping age group labels (e.g., &quot;25-34&quot;)</span>
<span class="sd">            to the number of respondents in each group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">age_groups</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mf">1.0</span><span class="p">:</span> <span class="s2">&quot;18-24&quot;</span><span class="p">,</span>
            <span class="mf">2.0</span><span class="p">:</span> <span class="s2">&quot;25-34&quot;</span><span class="p">,</span>
            <span class="mf">3.0</span><span class="p">:</span> <span class="s2">&quot;35-44&quot;</span><span class="p">,</span>
            <span class="mf">4.0</span><span class="p">:</span> <span class="s2">&quot;45-54&quot;</span><span class="p">,</span>
            <span class="mf">5.0</span><span class="p">:</span> <span class="s2">&quot;55+&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">age_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">age_Qind</span><span class="si">}</span><span class="s2"> 🔴  Укажите ваш  возраст&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">age_counts</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">age_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">age_groups</span><span class="p">)</span>
        <span class="n">age_counts</span> <span class="o">=</span> <span class="n">age_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">age_counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_industry_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">industry_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the distribution of respondents by industry.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            industry_Qind (int, optional): Index of the industry question. Defaults to 14.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, int]: Industry labels mapped to respondent counts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">industry_codes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Средства массовой информации и развлечения&quot;</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Здравоохранение&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Образование&quot;</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Некоммерческие организации, неправительственные организации&quot;</span><span class="p">,</span>
            <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Государственный сектор&quot;</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;Консалтинг&quot;</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;Недвижимость&quot;</span><span class="p">,</span>
            <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;Финансы&quot;</span><span class="p">,</span>
            <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;Технологии&quot;</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;Отели, Рестораны, Кейтеринг&quot;</span><span class="p">,</span>
            <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;Логистика&quot;</span><span class="p">,</span>
            <span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;Товары народного потребления&quot;</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;Торговля&quot;</span><span class="p">,</span>
            <span class="mi">14</span><span class="p">:</span> <span class="s2">&quot;Строительство&quot;</span><span class="p">,</span>
            <span class="mi">15</span><span class="p">:</span> <span class="s2">&quot;Энергетика&quot;</span><span class="p">,</span>
            <span class="mi">16</span><span class="p">:</span> <span class="s2">&quot;Производство&quot;</span><span class="p">,</span>
            <span class="mi">17</span><span class="p">:</span> <span class="s2">&quot;Добыча полезных ископаемых&quot;</span><span class="p">,</span>
            <span class="mi">18</span><span class="p">:</span> <span class="s2">&quot;Сельское хозяйство&quot;</span><span class="p">,</span>
            <span class="mi">19</span><span class="p">:</span> <span class="s2">&quot;Другое&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">industry_col</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">industry_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">industry_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">industry_col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">industry_counts</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">industry_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">industry_codes</span><span class="p">)</span>
        <span class="n">industry_counts</span> <span class="o">=</span> <span class="n">industry_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">industry_counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_job_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_Qinds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the distribution of selected job functions.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_Qinds (int, optional): Index of the job-related question. Defaults to 13.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, int]: Jobs labels mapped to selection counts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job_cols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">job_Qinds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span>
        <span class="p">]</span>
        <span class="n">jobs_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">job_cols</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">jobs_counts</span> <span class="o">=</span> <span class="n">jobs_counts</span><span class="p">[</span><span class="n">jobs_counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">jobs_counts</span> <span class="o">=</span> <span class="n">jobs_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">jobs_counts</span>

    <span class="c1"># below are methods for extracting data, used in boxplots</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_overall_csi</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qinds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns average CSI scores across key program components.</span>
<span class="sd">        This method extracts responses from multiple questions in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_Qinds (List[int], optional): Question indices for CSI blocks. Defaults to [2, 3, 5, 7, 8, 9].</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: Block labels mapped to per-respondent averages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Общая оценка&lt;br&gt;программы (Q2)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Насколько достигнуты&lt;br&gt;цели обучения (Q3)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Дизайн&lt;br&gt;программы (Q5)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Опыт на&lt;br&gt;международных&lt;br&gt;модулях (Q7)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Работа команды&lt;br&gt;программы (Q8)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Качество группы (Q9)&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">discrete_rate_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">csi_Qinds</span><span class="p">:</span>
            <span class="n">discrete_rate_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
            <span class="p">)</span>

        <span class="n">csi_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">discrete_rate_cols</span><span class="p">):</span>
            <span class="n">mean_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">csi_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_series</span>
        <span class="k">return</span> <span class="n">csi_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calulate_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the overall CSI from component-level CSI data.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_data (Dict[str, List[float]]): Average component scores for each section.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Averaged overall CSI score.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">component_csis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">csi_data</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">component_csis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">component_csis</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_csis</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_colnames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal helper for extracting CSI block data.</span>

<span class="sd">        Args:</span>
<span class="sd">            new_colnames (List[str]): New labels for each CSI subquestion.</span>
<span class="sd">            csi_Qind (int): Index of the CSI block question.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: Subquestion labels mapped to rating series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">csi_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">csi_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
        <span class="n">ratings</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">csi_cols</span><span class="p">]</span>
        <span class="n">csi_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">ratings</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">csi_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_basic_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the overall csi block.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_Qind (int, optional): Question index for this block. Defaults to 2.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Административная&lt;br&gt;поддержка&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Приобретенные&lt;br&gt;знания&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ППС&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_design_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;Program Design&#39; block.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_Qind (int, optional): Question index for this block. Defaults to 5.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Логичность&lt;br&gt;содержания&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Баланс теории&lt;br&gt;и практики&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Применимость&lt;br&gt;знаний&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Актуальность&lt;br&gt;знаний&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Соотношение&lt;br&gt;глобальных&lt;br&gt;и региональных&lt;br&gt;модулей&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Достаточность&lt;br&gt;проектной&lt;br&gt;работы&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Качество&lt;br&gt;выступающих&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_intern_modules_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;International Modules&#39; block.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_Qind (int, optional): Question index for this block. Defaults to 7.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Качество&lt;br&gt;кейсов&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Применимость&lt;br&gt;знаний&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Групповая&lt;br&gt;работа&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Выбор&lt;br&gt;локаций&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_support_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;Program Team Support&#39; block.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_Qind (int, optional): Question index for this block. Defaults to 8.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Отклик&lt;br&gt;на потребности&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Организация&lt;br&gt;образовательного&lt;br&gt;процесса&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_group_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;Group Quality&#39; block.</span>

<span class="sd">        Args:</span>
<span class="sd">            csi_Qind (int, optional): Question index for this block. Defaults to 9.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Поддержка</span><span class="se">\n</span><span class="s2">и взаимопомощь&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Опыт и знания</span><span class="se">\n</span><span class="s2">одногруппников&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Разнообразие</span><span class="se">\n</span><span class="s2">индустрий&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Приобритение</span><span class="se">\n</span><span class="s2">деловых</span><span class="se">\n</span><span class="s2">контактов&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>

    <span class="c1"># below are methods for extracting data, used in barplots</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_program_nps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nps_Qind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;12.1&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes Net Promoter Score (NPS) from the program recommendation question.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            nps_Qind (str, optional): Index of the NPS question. Defaults to &quot;12.1&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Calculated NPS value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nps_colname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">nps_Qind</span><span class="si">}</span><span class="s2">  - 🔴  Готовы ли вы порекомендовать программу своим друзьям/коллегам?&quot;</span>
        <span class="n">num_students</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_promoters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">nps_colname</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_critics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">nps_colname</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nps_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">num_promoters</span> <span class="o">-</span> <span class="n">num_critics</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_students</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nps_value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_industry_nps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns industry-level NPS comparison data for barplot rendering.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[List[str], List[int], List[str]]: Labels, values, and color mapping used in a barplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nps_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_program_nps</span><span class="p">()</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Уровень &#39;Отлично&#39;</span><span class="se">\n</span><span class="s2"> by Quesionstar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EMBA-35&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Сфера образования&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Сфера высшего</span><span class="se">\n</span><span class="s2">образования&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="n">nps_value</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">51</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#A9A9A9&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#FF007F&quot;</span>
        <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_programs_nps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns NPS data comparing different program cohorts.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[List[str], List[int], List[str]]: Labels, values, and color mapping used in a barplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nps_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_program_nps</span><span class="p">()</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;EMBA-31+32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EMBA-33&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EMBA-34&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EMBA-35&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SKOLKOVO DEGREE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SKOLKOVO EMBA average&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="n">nps_value</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">77</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#A9A9A9&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#FF007F&quot;</span>
        <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_pilos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nps_Qind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns counts of ratings for each PILO (Program Intended Learning Outcome).</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            nps_Qind (str, optional): Index of the PILO question. Defaults to 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Aggregated rating counts per PILO item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q3_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">nps_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Экспертный&lt;br&gt;уровень знания&lt;br&gt;бизнес-дисциплин&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Анализ данных&lt;br&gt;для принятия&lt;br&gt;решений&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Определение&lt;br&gt;стратегии для&lt;br&gt;устойчивого&lt;br&gt;развития&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Интеграционное&lt;br&gt;лидерство&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Эффективная&lt;br&gt;коммуникация&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Структурирование&lt;br&gt;стратегий&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Оценка контекста&lt;br&gt;и технологий&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Внедрение&lt;br&gt;ERS&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Креативность&lt;br&gt;новаторство&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Предпринимательское&lt;br&gt;мышление&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">PILOs_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">q3_cols</span><span class="p">]</span>
        <span class="n">PILOs_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new_colnames</span>
        <span class="n">PILOs_df</span> <span class="o">=</span> <span class="n">PILOs_df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">PILOs_df</span> <span class="o">=</span> <span class="n">PILOs_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;param&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">)</span>
        <span class="n">score_counts</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">PILOs_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;param&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">score_counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_top_lectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lectors_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a ranked count of most frequently selected lecturers.</span>
<span class="sd">        This method extracts responses from a specific question in the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            lectors_Qind (int, optional): Index of the lecturer evaluation question. Defaults to 6.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, int]: Lecturer names mapped to selection counts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lectors_cols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">lectors_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">all_lectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">lectors_cols</span><span class="p">]</span>
        <span class="n">mask_all_zeros</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_lectors</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">zeros_count</span> <span class="o">=</span> <span class="n">mask_all_zeros</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">lectors</span> <span class="o">=</span> <span class="n">all_lectors</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">mask_all_zeros</span><span class="p">,</span> <span class="n">lectors_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">lectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">lector</span> <span class="k">for</span> <span class="n">lector</span> <span class="ow">in</span> <span class="n">lectors</span> <span class="k">if</span> <span class="n">lector</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">lectors_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lectors</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">lectors_counts</span><span class="p">[</span><span class="s2">&quot;Никто&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeros_count</span>
        <span class="n">lectors_counts</span> <span class="o">=</span> <span class="n">lectors_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lectors_counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_collaborators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collab_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the distribution of preferred alumni collaboration formats.</span>

<span class="sd">        Args:</span>
<span class="sd">            collab_Qind (int, optional): Index of the collaboration question. Defaults to 11.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, int]: Collaboration types mapped to respondent counts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;качестве приглашенного спикера&quot;</span><span class="p">,</span>
            <span class="s2">&quot;качестве ментора&quot;</span><span class="p">,</span>
            <span class="s2">&quot;мероприятиях для выпускников&quot;</span><span class="p">,</span>
            <span class="s2">&quot;адмиссии&quot;</span><span class="p">,</span>
            <span class="s2">&quot;другое&quot;</span><span class="p">,</span>
            <span class="s2">&quot;в качестве протагониста&quot;</span><span class="p">,</span>
            <span class="s2">&quot;отказываюсь&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">events_cols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">collab_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">collab_Qind</span><span class="si">}</span><span class="s2">.1.&quot;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">all_events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">events_cols</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;No comments&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">all_events</span><span class="p">[</span><span class="s2">&quot;Отказываюсь&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">all_events</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">all_events</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new_colnames</span>

        <span class="n">events_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_colnames</span><span class="p">:</span>
            <span class="n">events_counts</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_events</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">events_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">events_counts</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">events_counts</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">table_path</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize an extractor object</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table_path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.IO">IO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>string with a path to a structured Excel tables or a file-like object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">IO</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize an extractor object</span>

<span class="sd">    Args:</span>
<span class="sd">        table_path (str | IO): string with a path to a structured Excel tables or a file-like object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">table_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.calulate_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calulate_csi</span><span class="p">(</span><span class="n">csi_data</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculates the overall CSI from component-level CSI data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Average component scores for each section.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Averaged overall CSI score.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calulate_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the overall CSI from component-level CSI data.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_data (Dict[str, List[float]]): Average component scores for each section.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Averaged overall CSI score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">component_csis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">csi_data</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="n">component_csis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">component_csis</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_csis</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_age_distr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_age_distr</span><span class="p">(</span><span class="n">age_Qind</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the distribution of respondents by age group.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>age_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the question containing age group information. Defaults to 15.</p>
              </div>
            </td>
            <td>
                  <code>15</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, int]: A dictionary mapping age group labels (e.g., "25-34")</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>to the number of respondents in each group.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_age_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the distribution of respondents by age group.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        age_Qind (int, optional): The index of the question containing age group information. Defaults to 15.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, int]: A dictionary mapping age group labels (e.g., &quot;25-34&quot;)</span>
<span class="sd">        to the number of respondents in each group.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">age_groups</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mf">1.0</span><span class="p">:</span> <span class="s2">&quot;18-24&quot;</span><span class="p">,</span>
        <span class="mf">2.0</span><span class="p">:</span> <span class="s2">&quot;25-34&quot;</span><span class="p">,</span>
        <span class="mf">3.0</span><span class="p">:</span> <span class="s2">&quot;35-44&quot;</span><span class="p">,</span>
        <span class="mf">4.0</span><span class="p">:</span> <span class="s2">&quot;45-54&quot;</span><span class="p">,</span>
        <span class="mf">5.0</span><span class="p">:</span> <span class="s2">&quot;55+&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">age_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">age_Qind</span><span class="si">}</span><span class="s2"> 🔴  Укажите ваш  возраст&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">age_counts</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">age_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">age_groups</span><span class="p">)</span>
    <span class="n">age_counts</span> <span class="o">=</span> <span class="n">age_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">age_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_basic_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_basic_csi</span><span class="p">(</span><span class="n">csi_Qind</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns CSI data for the overall csi block.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Question index for this block. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, pd.Series]: CSI item labels mapped to rating series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_basic_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the overall csi block.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_Qind (int, optional): Question index for this block. Defaults to 2.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Административная&lt;br&gt;поддержка&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Приобретенные&lt;br&gt;знания&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ППС&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_collaborators" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_collaborators</span><span class="p">(</span><span class="n">collab_Qind</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the distribution of preferred alumni collaboration formats.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>collab_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the collaboration question. Defaults to 11.</p>
              </div>
            </td>
            <td>
                  <code>11</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, int]: Collaboration types mapped to respondent counts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_collaborators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collab_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the distribution of preferred alumni collaboration formats.</span>

<span class="sd">    Args:</span>
<span class="sd">        collab_Qind (int, optional): Index of the collaboration question. Defaults to 11.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, int]: Collaboration types mapped to respondent counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;качестве приглашенного спикера&quot;</span><span class="p">,</span>
        <span class="s2">&quot;качестве ментора&quot;</span><span class="p">,</span>
        <span class="s2">&quot;мероприятиях для выпускников&quot;</span><span class="p">,</span>
        <span class="s2">&quot;адмиссии&quot;</span><span class="p">,</span>
        <span class="s2">&quot;другое&quot;</span><span class="p">,</span>
        <span class="s2">&quot;в качестве протагониста&quot;</span><span class="p">,</span>
        <span class="s2">&quot;отказываюсь&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">events_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">collab_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="ow">and</span> <span class="ow">not</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">collab_Qind</span><span class="si">}</span><span class="s2">.1.&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">all_events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">events_cols</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;No comments&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">all_events</span><span class="p">[</span><span class="s2">&quot;Отказываюсь&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">all_events</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">all_events</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new_colnames</span>

    <span class="n">events_counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_colnames</span><span class="p">:</span>
        <span class="n">events_counts</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_events</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">events_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">events_counts</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">events_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_design_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_design_csi</span><span class="p">(</span><span class="n">csi_Qind</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns CSI data for the 'Program Design' block.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Question index for this block. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, pd.Series]: CSI item labels mapped to rating series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_design_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;Program Design&#39; block.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_Qind (int, optional): Question index for this block. Defaults to 5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Логичность&lt;br&gt;содержания&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Баланс теории&lt;br&gt;и практики&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Применимость&lt;br&gt;знаний&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Актуальность&lt;br&gt;знаний&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Соотношение&lt;br&gt;глобальных&lt;br&gt;и региональных&lt;br&gt;модулей&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Достаточность&lt;br&gt;проектной&lt;br&gt;работы&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Качество&lt;br&gt;выступающих&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_group_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_group_csi</span><span class="p">(</span><span class="n">csi_Qind</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns CSI data for the 'Group Quality' block.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Question index for this block. Defaults to 9.</p>
              </div>
            </td>
            <td>
                  <code>9</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, pd.Series]: CSI item labels mapped to rating series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_group_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">9</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;Group Quality&#39; block.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_Qind (int, optional): Question index for this block. Defaults to 9.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Поддержка</span><span class="se">\n</span><span class="s2">и взаимопомощь&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Опыт и знания</span><span class="se">\n</span><span class="s2">одногруппников&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Разнообразие</span><span class="se">\n</span><span class="s2">индустрий&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Приобритение</span><span class="se">\n</span><span class="s2">деловых</span><span class="se">\n</span><span class="s2">контактов&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_industry_distr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_industry_distr</span><span class="p">(</span><span class="n">industry_Qind</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the distribution of respondents by industry.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>industry_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the industry question. Defaults to 14.</p>
              </div>
            </td>
            <td>
                  <code>14</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, int]: Industry labels mapped to respondent counts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_industry_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">industry_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the distribution of respondents by industry.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        industry_Qind (int, optional): Index of the industry question. Defaults to 14.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, int]: Industry labels mapped to respondent counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">industry_codes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Средства массовой информации и развлечения&quot;</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Здравоохранение&quot;</span><span class="p">,</span>
        <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Образование&quot;</span><span class="p">,</span>
        <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Некоммерческие организации, неправительственные организации&quot;</span><span class="p">,</span>
        <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;Государственный сектор&quot;</span><span class="p">,</span>
        <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;Консалтинг&quot;</span><span class="p">,</span>
        <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;Недвижимость&quot;</span><span class="p">,</span>
        <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;Финансы&quot;</span><span class="p">,</span>
        <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;Технологии&quot;</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;Отели, Рестораны, Кейтеринг&quot;</span><span class="p">,</span>
        <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;Логистика&quot;</span><span class="p">,</span>
        <span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;Товары народного потребления&quot;</span><span class="p">,</span>
        <span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;Торговля&quot;</span><span class="p">,</span>
        <span class="mi">14</span><span class="p">:</span> <span class="s2">&quot;Строительство&quot;</span><span class="p">,</span>
        <span class="mi">15</span><span class="p">:</span> <span class="s2">&quot;Энергетика&quot;</span><span class="p">,</span>
        <span class="mi">16</span><span class="p">:</span> <span class="s2">&quot;Производство&quot;</span><span class="p">,</span>
        <span class="mi">17</span><span class="p">:</span> <span class="s2">&quot;Добыча полезных ископаемых&quot;</span><span class="p">,</span>
        <span class="mi">18</span><span class="p">:</span> <span class="s2">&quot;Сельское хозяйство&quot;</span><span class="p">,</span>
        <span class="mi">19</span><span class="p">:</span> <span class="s2">&quot;Другое&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">industry_col</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">industry_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span>
    <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">industry_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">industry_col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">industry_counts</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">industry_counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">industry_codes</span><span class="p">)</span>
    <span class="n">industry_counts</span> <span class="o">=</span> <span class="n">industry_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">industry_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_industry_nps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_industry_nps</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns industry-level NPS comparison data for barplot rendering.
This method extracts responses from a specific question in the table.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="typing.List">List</span>[<span title="int">int</span>], <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[List[str], List[int], List[str]]: Labels, values, and color mapping used in a barplot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_industry_nps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns industry-level NPS comparison data for barplot rendering.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[List[str], List[int], List[str]]: Labels, values, and color mapping used in a barplot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nps_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_program_nps</span><span class="p">()</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Уровень &#39;Отлично&#39;</span><span class="se">\n</span><span class="s2"> by Quesionstar&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EMBA-35&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Сфера образования&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Сфера высшего</span><span class="se">\n</span><span class="s2">образования&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="n">nps_value</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">51</span><span class="p">]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#A9A9A9&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#FF007F&quot;</span>
    <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_intern_modules_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_intern_modules_csi</span><span class="p">(</span><span class="n">csi_Qind</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns CSI data for the 'International Modules' block.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Question index for this block. Defaults to 7.</p>
              </div>
            </td>
            <td>
                  <code>7</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, pd.Series]: CSI item labels mapped to rating series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_intern_modules_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;International Modules&#39; block.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_Qind (int, optional): Question index for this block. Defaults to 7.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Качество&lt;br&gt;кейсов&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Применимость&lt;br&gt;знаний&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Групповая&lt;br&gt;работа&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Выбор&lt;br&gt;локаций&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_job_distr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_job_distr</span><span class="p">(</span><span class="n">job_Qinds</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the distribution of selected job functions.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>job_Qinds</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the job-related question. Defaults to 13.</p>
              </div>
            </td>
            <td>
                  <code>13</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, int]: Jobs labels mapped to selection counts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_job_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_Qinds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the distribution of selected job functions.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_Qinds (int, optional): Index of the job-related question. Defaults to 13.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, int]: Jobs labels mapped to selection counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">job_Qinds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span>
    <span class="p">]</span>
    <span class="n">jobs_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">job_cols</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">jobs_counts</span> <span class="o">=</span> <span class="n">jobs_counts</span><span class="p">[</span><span class="n">jobs_counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">jobs_counts</span> <span class="o">=</span> <span class="n">jobs_counts</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">jobs_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_overall_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_overall_csi</span><span class="p">(</span><span class="n">csi_Qinds</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns average CSI scores across key program components.
This method extracts responses from multiple questions in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_Qinds</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Question indices for CSI blocks. Defaults to [2, 3, 5, 7, 8, 9].</p>
              </div>
            </td>
            <td>
                  <code>[2, 3, 5, 7, 8, 9]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, pd.Series]: Block labels mapped to per-respondent averages.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_overall_csi</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qinds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns average CSI scores across key program components.</span>
<span class="sd">    This method extracts responses from multiple questions in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_Qinds (List[int], optional): Question indices for CSI blocks. Defaults to [2, 3, 5, 7, 8, 9].</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, pd.Series]: Block labels mapped to per-respondent averages.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Общая оценка&lt;br&gt;программы (Q2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Насколько достигнуты&lt;br&gt;цели обучения (Q3)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Дизайн&lt;br&gt;программы (Q5)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Опыт на&lt;br&gt;международных&lt;br&gt;модулях (Q7)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Работа команды&lt;br&gt;программы (Q8)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Качество группы (Q9)&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">discrete_rate_cols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">csi_Qinds</span><span class="p">:</span>
        <span class="n">discrete_rate_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
        <span class="p">)</span>

    <span class="n">csi_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">discrete_rate_cols</span><span class="p">):</span>
        <span class="n">mean_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">csi_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_series</span>
    <span class="k">return</span> <span class="n">csi_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_pilos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pilos</span><span class="p">(</span><span class="n">nps_Qind</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns counts of ratings for each PILO (Program Intended Learning Outcome).
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nps_Qind</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the PILO question. Defaults to 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Aggregated rating counts per PILO item.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_pilos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nps_Qind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns counts of ratings for each PILO (Program Intended Learning Outcome).</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        nps_Qind (str, optional): Index of the PILO question. Defaults to 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Aggregated rating counts per PILO item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q3_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">nps_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)]</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Экспертный&lt;br&gt;уровень знания&lt;br&gt;бизнес-дисциплин&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Анализ данных&lt;br&gt;для принятия&lt;br&gt;решений&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Определение&lt;br&gt;стратегии для&lt;br&gt;устойчивого&lt;br&gt;развития&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Интеграционное&lt;br&gt;лидерство&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Эффективная&lt;br&gt;коммуникация&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Структурирование&lt;br&gt;стратегий&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Оценка контекста&lt;br&gt;и технологий&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Внедрение&lt;br&gt;ERS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Креативность&lt;br&gt;новаторство&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Предпринимательское&lt;br&gt;мышление&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">PILOs_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">q3_cols</span><span class="p">]</span>
    <span class="n">PILOs_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new_colnames</span>
    <span class="n">PILOs_df</span> <span class="o">=</span> <span class="n">PILOs_df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">PILOs_df</span> <span class="o">=</span> <span class="n">PILOs_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;param&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">)</span>
    <span class="n">score_counts</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">PILOs_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;param&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">score_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_programs_nps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_programs_nps</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns NPS data comparing different program cohorts.
This method extracts responses from a specific question in the table.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="typing.List">List</span>[<span title="int">int</span>], <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[List[str], List[int], List[str]]: Labels, values, and color mapping used in a barplot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_programs_nps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns NPS data comparing different program cohorts.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[List[str], List[int], List[str]]: Labels, values, and color mapping used in a barplot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nps_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_program_nps</span><span class="p">()</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;EMBA-31+32&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EMBA-33&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EMBA-34&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EMBA-35&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SKOLKOVO DEGREE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SKOLKOVO EMBA average&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="n">nps_value</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">77</span><span class="p">]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#A9A9A9&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#FF007F&quot;</span>
    <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_support_csi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_support_csi</span><span class="p">(</span><span class="n">csi_Qind</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns CSI data for the 'Program Team Support' block.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>csi_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Question index for this block. Defaults to 8.</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, pd.Series]: CSI item labels mapped to rating series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_support_csi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns CSI data for the &#39;Program Team Support&#39; block.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        csi_Qind (int, optional): Question index for this block. Defaults to 8.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, pd.Series]: CSI item labels mapped to rating series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_colnames</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Отклик&lt;br&gt;на потребности&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Организация&lt;br&gt;образовательного&lt;br&gt;процесса&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_csi</span><span class="p">(</span><span class="n">new_colnames</span><span class="p">,</span> <span class="n">csi_Qind</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.data_extractors.ExitEmbaExtractor.get_top_lectors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_top_lectors</span><span class="p">(</span><span class="n">lectors_Qind</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a ranked count of most frequently selected lecturers.
This method extracts responses from a specific question in the table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lectors_Qind</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the lecturer evaluation question. Defaults to 6.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, int]: Lecturer names mapped to selection counts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/data_extractors.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_top_lectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lectors_Qind</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a ranked count of most frequently selected lecturers.</span>
<span class="sd">    This method extracts responses from a specific question in the table.</span>

<span class="sd">    Args:</span>
<span class="sd">        lectors_Qind (int, optional): Index of the lecturer evaluation question. Defaults to 6.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, int]: Lecturer names mapped to selection counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lectors_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Q</span><span class="si">{</span><span class="n">lectors_Qind</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">all_lectors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">lectors_cols</span><span class="p">]</span>
    <span class="n">mask_all_zeros</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_lectors</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">zeros_count</span> <span class="o">=</span> <span class="n">mask_all_zeros</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">lectors</span> <span class="o">=</span> <span class="n">all_lectors</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">mask_all_zeros</span><span class="p">,</span> <span class="n">lectors_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">lectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">lector</span> <span class="k">for</span> <span class="n">lector</span> <span class="ow">in</span> <span class="n">lectors</span> <span class="k">if</span> <span class="n">lector</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">lectors_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lectors</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">lectors_counts</span><span class="p">[</span><span class="s2">&quot;Никто&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeros_count</span>
    <span class="n">lectors_counts</span> <span class="o">=</span> <span class="n">lectors_counts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">lectors_counts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="app.backend.plotter" class="doc doc-heading">
            <code>app.backend.plotter</code>


</h2>

    <div class="doc doc-contents first">

        <p>Classes for creating various plots.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="app.backend.plotter.PlotGenerator" class="doc doc-heading">
            <code>PlotGenerator</code>


</h3>


    <div class="doc doc-contents ">


        <p>A utility class for generating various types of interactive plots using Plotly.</p>
<p>This class provides reusable methods to construct common survey visualizations such
as boxplots, pie charts, NPS barplots, horizontal barplots, and stacked barplots. It
also includes helpers to add custom titles, background shapes, and dummy legends.</p>


<details class="class-attributes" open>
  <summary>Class Attributes</summary>
  <p>title_template (dict): Default layout template for plot titles.</p>
<p>rectangle_template (dict): Default template for background rectangle shapes.</p>
</details>

<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="make_boxplot(data, title)

  
      classmethod
   (app.backend.plotter.PlotGenerator.make_boxplot)" href="#app.backend.plotter.PlotGenerator.make_boxplot">make_boxplot</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a boxplot for grouped numerical data.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="make_piechart(data, title)

  
      classmethod
   (app.backend.plotter.PlotGenerator.make_piechart)" href="#app.backend.plotter.PlotGenerator.make_piechart">make_piechart</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Creates a donut-style pie chart with total annotation.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="make_nps_barplot(barnames, values, colors, title)

  
      classmethod
   (app.backend.plotter.PlotGenerator.make_nps_barplot)" href="#app.backend.plotter.PlotGenerator.make_nps_barplot">make_nps_barplot</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Builds a customized barplot for Net Promoter Score analysis.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="make_stacked_barplot(score_counts, title, x_axs_title='x', y_axs_title='y')

  
      classmethod
   (app.backend.plotter.PlotGenerator.make_stacked_barplot)" href="#app.backend.plotter.PlotGenerator.make_stacked_barplot">make_stacked_barplot</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Constructs a stacked barplot with weighted means.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="make_hbarplot(score_counts, title, x_axs_title='x', y_axs_title='y')

  
      classmethod
   (app.backend.plotter.PlotGenerator.make_hbarplot)" href="#app.backend.plotter.PlotGenerator.make_hbarplot">make_hbarplot</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Produces a horizontal barplot with color encoding.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>src/app/backend/plotter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlotGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A utility class for generating various types of interactive plots using Plotly.</span>

<span class="sd">    This class provides reusable methods to construct common survey visualizations such</span>
<span class="sd">    as boxplots, pie charts, NPS barplots, horizontal barplots, and stacked barplots. It</span>
<span class="sd">    also includes helpers to add custom titles, background shapes, and dummy legends.</span>

<span class="sd">    Class Attributes:</span>
<span class="sd">        title_template (dict): Default layout template for plot titles.</span>

<span class="sd">        rectangle_template (dict): Default template for background rectangle shapes.</span>

<span class="sd">    Methods:</span>
<span class="sd">        make_boxplot: Generates a boxplot for grouped numerical data.</span>
<span class="sd">        make_piechart: Creates a donut-style pie chart with total annotation.</span>
<span class="sd">        make_nps_barplot: Builds a customized barplot for Net Promoter Score analysis.</span>
<span class="sd">        make_stacked_barplot: Constructs a stacked barplot with weighted means.</span>
<span class="sd">        make_hbarplot: Produces a horizontal barplot with color encoding.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">title_template</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;SAMPLE_TITLE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.45</span><span class="p">,</span>
        <span class="s2">&quot;xanchor&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="s2">&quot;font&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">rectangle_template</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;rect&quot;</span><span class="p">,</span>
        <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
        <span class="n">yref</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">y1</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;SAMPLE COLOR&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
        <span class="n">line_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_make_title</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">title_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a plot title dictionary based on the class template.</span>

<span class="sd">        Args:</span>
<span class="sd">            title_text (str): The title text to display.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary representing the plot title layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">title_template</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">title</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title_text</span>
        <span class="k">return</span> <span class="n">title</span>

    <span class="c1"># used in nps barplots as backgroud</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_edit_shape</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a rectangular shape dictionary for plot background highlighting.</span>

<span class="sd">        Args:</span>
<span class="sd">            y0 (int): The lower bound on the y-axis.</span>
<span class="sd">            y1 (int): The upper bound on the y-axis.</span>
<span class="sd">            color (str): The fill color of the rectangle.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary representing the shape layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">rectangle_template</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">shape</span><span class="p">[</span><span class="s2">&quot;fillcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="n">shape</span><span class="p">[</span><span class="s2">&quot;y0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
        <span class="n">shape</span><span class="p">[</span><span class="s2">&quot;y1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1</span>
        <span class="k">return</span> <span class="n">shape</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_make_legend</span><span class="p">(</span><span class="n">legend_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a dummy invisible scatter trace to serve as a custom legend item.</span>

<span class="sd">        Args:</span>
<span class="sd">            legend_text (str): The label text for the legend.</span>
<span class="sd">            color (str): The marker color for the legend.</span>

<span class="sd">        Returns:</span>
<span class="sd">            go.Scatter: A Plotly scatter trace configured for the legend.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dummy_legend</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">legend_text</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">invisible_fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">dummy_legend</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">invisible_fig</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_boxplot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a boxplot figure with grouped data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Dict[str, List[float]]): Dictionary mapping group names to numerical data.</span>
<span class="sd">            title (str): Title of the plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            go.Figure: Plotly figure object with boxplot traces.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">boxmean</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_piechart</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a donut-style pie chart with total value annotation.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Dict[str, float]): Dictionary mapping labels to values.</span>
<span class="sd">            title (str): Title of the plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            go.Figure: Plotly figure object with a pie chart.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Pie</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">name</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">hole</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;value+percent+label&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
            <span class="n">annotations</span><span class="o">=</span><span class="p">[</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_nps_barplot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">barnames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">colors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a Net Promoter Score (NPS) styled barplot with color-coded background.</span>

<span class="sd">        Args:</span>
<span class="sd">            barnames (List[str]): Names for each bar.</span>
<span class="sd">            values (List[int]): Numerical values for each bar.</span>
<span class="sd">            colors (List[str]): Colors corresponding to each bar.</span>
<span class="sd">            title (str): Title of the plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            go.Figure: Plotly figure object with NPS barplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">barnames</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;Good (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#b2df8a&quot;</span><span class="p">),</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;Favorable (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#66bb6a&quot;</span><span class="p">),</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;Excellent (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#388e3c&quot;</span><span class="p">),</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;World class (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1b5e20&quot;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
            <span class="n">shapes</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#b2df8a&quot;</span><span class="p">),</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#66bb6a&quot;</span><span class="p">),</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#388e3c&quot;</span><span class="p">),</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1b5e20&quot;</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_stacked_barplot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">score_counts</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">x_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">y_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a stacked barplot with color-coded scores and weighted mean annotations.</span>

<span class="sd">        Args:</span>
<span class="sd">            score_counts (pd.DataFrame): DataFrame containing counts per score per category.</span>
<span class="sd">            title (str): Title of the plot.</span>
<span class="sd">            x_axs_title (str, optional): Label for the x-axis. Defaults to &quot;x&quot;.</span>
<span class="sd">            y_axs_title (str, optional): Label for the y-axis. Defaults to &quot;y&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            go.Figure: Plotly figure object with stacked barplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">sample_colorscale</span><span class="p">(</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">9</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
        <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">score_counts</span><span class="p">[</span><span class="s2">&quot;param&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">score_counts</span><span class="p">[</span><span class="n">score</span><span class="p">],</span>
                    <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">),</span>
                    <span class="n">marker_color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">score</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># calculate weighted means for each bar</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">score_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># [n_categories, 10]</span>
        <span class="n">weighted_means</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span> <span class="o">*</span> <span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">score_counts</span><span class="p">[</span><span class="s2">&quot;param&quot;</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wm</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">wm</span> <span class="ow">in</span> <span class="n">weighted_means</span><span class="p">],</span>
                <span class="n">textposition</span><span class="o">=</span><span class="s2">&quot;top center&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;Среднее&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
            <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x_axs_title</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_axs_title</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_hbarplot</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">score_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">x_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">y_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a horizontal barplot with color-coded bars based on values.</span>

<span class="sd">        Args:</span>
<span class="sd">            score_counts (Dict[str, int]): Dictionary mapping categories to values.</span>
<span class="sd">            title (str): Title of the plot.</span>
<span class="sd">            x_axs_title (str, optional): Label for the x-axis. Defaults to &quot;x&quot;.</span>
<span class="sd">            y_axs_title (str, optional): Label for the y-axis. Defaults to &quot;y&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            go.Figure: Plotly figure object with horizontal barplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">num_colors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">sample_colorscale</span><span class="p">(</span>
            <span class="s2">&quot;Greens&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_colors</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_colors</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">votes_to_colors</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">palette</span><span class="p">))</span>
        <span class="n">scores_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">votes_to_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                <span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                <span class="n">marker_color</span><span class="o">=</span><span class="n">scores_colors</span><span class="p">,</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
            <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x_axs_title</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_axs_title</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="app.backend.plotter.PlotGenerator.make_boxplot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_boxplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a boxplot figure with grouped data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping group names to numerical data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Figure: Plotly figure object with boxplot traces.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/plotter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_boxplot</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a boxplot figure with grouped data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Dict[str, List[float]]): Dictionary mapping group names to numerical data.</span>
<span class="sd">        title (str): Title of the plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        go.Figure: Plotly figure object with boxplot traces.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">boxmean</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.plotter.PlotGenerator.make_hbarplot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_hbarplot</span><span class="p">(</span><span class="n">score_counts</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">x_axs_title</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_axs_title</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a horizontal barplot with color-coded bars based on values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>score_counts</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping categories to values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_axs_title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the x-axis. Defaults to "x".</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_axs_title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the y-axis. Defaults to "y".</p>
              </div>
            </td>
            <td>
                  <code>&#39;y&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Figure: Plotly figure object with horizontal barplot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/plotter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_hbarplot</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">score_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">x_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a horizontal barplot with color-coded bars based on values.</span>

<span class="sd">    Args:</span>
<span class="sd">        score_counts (Dict[str, int]): Dictionary mapping categories to values.</span>
<span class="sd">        title (str): Title of the plot.</span>
<span class="sd">        x_axs_title (str, optional): Label for the x-axis. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_axs_title (str, optional): Label for the y-axis. Defaults to &quot;y&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        go.Figure: Plotly figure object with horizontal barplot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">num_colors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">palette</span> <span class="o">=</span> <span class="n">sample_colorscale</span><span class="p">(</span>
        <span class="s2">&quot;Greens&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_colors</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_colors</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="n">votes_to_colors</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">palette</span><span class="p">))</span>
    <span class="n">scores_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">votes_to_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
            <span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">score_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="n">marker_color</span><span class="o">=</span><span class="n">scores_colors</span><span class="p">,</span>
            <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
        <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x_axs_title</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_axs_title</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.plotter.PlotGenerator.make_nps_barplot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_nps_barplot</span><span class="p">(</span><span class="n">barnames</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a Net Promoter Score (NPS) styled barplot with color-coded background.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>barnames</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names for each bar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numerical values for each bar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colors</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colors corresponding to each bar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Figure: Plotly figure object with NPS barplot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/plotter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_nps_barplot</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">barnames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">colors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a Net Promoter Score (NPS) styled barplot with color-coded background.</span>

<span class="sd">    Args:</span>
<span class="sd">        barnames (List[str]): Names for each bar.</span>
<span class="sd">        values (List[int]): Numerical values for each bar.</span>
<span class="sd">        colors (List[str]): Colors corresponding to each bar.</span>
<span class="sd">        title (str): Title of the plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        go.Figure: Plotly figure object with NPS barplot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">barnames</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;Good (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#b2df8a&quot;</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;Favorable (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#66bb6a&quot;</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;Excellent (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#388e3c&quot;</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_make_legend</span><span class="p">(</span><span class="s2">&quot;World class (by Bain&amp;Company)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1b5e20&quot;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="n">shapes</span><span class="o">=</span><span class="p">[</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#b2df8a&quot;</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#66bb6a&quot;</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#388e3c&quot;</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_edit_shape</span><span class="p">(</span><span class="n">y0</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1b5e20&quot;</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.plotter.PlotGenerator.make_piechart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_piechart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a donut-style pie chart with total value annotation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping labels to values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Figure: Plotly figure object with a pie chart.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/plotter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_piechart</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a donut-style pie chart with total value annotation.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Dict[str, float]): Dictionary mapping labels to values.</span>
<span class="sd">        title (str): Title of the plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        go.Figure: Plotly figure object with a pie chart.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Pie</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">name</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">hole</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;value+percent+label&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
        <span class="n">annotations</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&lt;/b&gt;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="app.backend.plotter.PlotGenerator.make_stacked_barplot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_stacked_barplot</span><span class="p">(</span><span class="n">score_counts</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">x_axs_title</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_axs_title</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Generate a stacked barplot with color-coded scores and weighted mean annotations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>score_counts</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing counts per score per category.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_axs_title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the x-axis. Defaults to "x".</p>
              </div>
            </td>
            <td>
                  <code>&#39;x&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_axs_title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the y-axis. Defaults to "y".</p>
              </div>
            </td>
            <td>
                  <code>&#39;y&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Figure: Plotly figure object with stacked barplot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/plotter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_stacked_barplot</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">score_counts</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">x_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y_axs_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a stacked barplot with color-coded scores and weighted mean annotations.</span>

<span class="sd">    Args:</span>
<span class="sd">        score_counts (pd.DataFrame): DataFrame containing counts per score per category.</span>
<span class="sd">        title (str): Title of the plot.</span>
<span class="sd">        x_axs_title (str, optional): Label for the x-axis. Defaults to &quot;x&quot;.</span>
<span class="sd">        y_axs_title (str, optional): Label for the y-axis. Defaults to &quot;y&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        go.Figure: Plotly figure object with stacked barplot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">sample_colorscale</span><span class="p">(</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="mi">9</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
    <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">score_counts</span><span class="p">[</span><span class="s2">&quot;param&quot;</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">score_counts</span><span class="p">[</span><span class="n">score</span><span class="p">],</span>
                <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">),</span>
                <span class="n">marker_color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">score</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># calculate weighted means for each bar</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">score_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># [n_categories, 10]</span>
    <span class="n">weighted_means</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span> <span class="o">*</span> <span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">score_counts</span><span class="p">[</span><span class="s2">&quot;param&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wm</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">wm</span> <span class="ow">in</span> <span class="n">weighted_means</span><span class="p">],</span>
            <span class="n">textposition</span><span class="o">=</span><span class="s2">&quot;top center&quot;</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;Среднее&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_title</span><span class="p">(</span><span class="n">title</span><span class="p">),</span>
        <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x_axs_title</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_axs_title</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">tickangle</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="app.backend.raw_data_processor" class="doc doc-heading">
            <code>app.backend.raw_data_processor</code>


</h2>

    <div class="doc doc-contents first">

        <p>Add classes and funtioncs for processing raw survey tables here.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="app.backend.raw_data_processor.process_exit_survey" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_exit_survey</span><span class="p">(</span><span class="n">raw_table</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Cleans and preprocesses raw exit survey data from an Excel file or stream.</p>
<p>The function performs the following steps:
- Loads the Excel data, skipping header rows.
- Drops irrelevant columns including service and unnamed columns.
- Removes rows missing participant names.
- Fills missing professor names with a placeholder.
- Imputes missing ages with the median age.
- Fills missing scores in selected columns with column means.
- Sets default text for missing answers in specified free-answer columns.
- Returns the cleaned data as an in-memory Excel file stream.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>raw_table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.IO">IO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Excel file or file-like object containing raw survey data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>BytesIO</code></td>            <td>
                  <code><span title="io.BytesIO">BytesIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In-memory binary stream containing the cleaned Excel data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/app/backend/raw_data_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_exit_survey</span><span class="p">(</span><span class="n">raw_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">IO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BytesIO</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleans and preprocesses raw exit survey data from an Excel file or stream.</span>

<span class="sd">    The function performs the following steps:</span>
<span class="sd">    - Loads the Excel data, skipping header rows.</span>
<span class="sd">    - Drops irrelevant columns including service and unnamed columns.</span>
<span class="sd">    - Removes rows missing participant names.</span>
<span class="sd">    - Fills missing professor names with a placeholder.</span>
<span class="sd">    - Imputes missing ages with the median age.</span>
<span class="sd">    - Fills missing scores in selected columns with column means.</span>
<span class="sd">    - Sets default text for missing answers in specified free-answer columns.</span>
<span class="sd">    - Returns the cleaned data as an in-memory Excel file stream.</span>

<span class="sd">    Args:</span>
<span class="sd">        raw_table (str | IO): Path to the Excel file or file-like object containing raw survey data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        BytesIO: In-memory binary stream containing the cleaned Excel data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">raw_table</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

    <span class="n">service_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)]</span>
    <span class="n">unnamed_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Unnamed:&quot;</span><span class="p">)]</span>
    <span class="n">cols_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PS0 Start&quot;</span><span class="p">,</span> <span class="s2">&quot;PD0 Duration , sec&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">service_cols</span> <span class="o">+</span> <span class="n">unnamed_cols</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_to_drop</span><span class="p">)</span>

    <span class="c1"># drop all rows where participant name is None</span>
    <span class="n">name_col</span> <span class="o">=</span> <span class="s2">&quot;Q16  - 🔴 Укажите  фамилию и имя&quot;</span>
    <span class="n">q6_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Q6&quot;</span><span class="p">)]</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">name_col</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># if a student doesnt remember any professors</span>
    <span class="n">raw_data</span><span class="p">[</span><span class="n">q6_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">q6_cols</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Никто&quot;</span><span class="p">)</span>

    <span class="c1"># if the age was not provided fill with mode</span>
    <span class="n">age_col</span> <span class="o">=</span> <span class="s2">&quot;Q15 🔴  Укажите ваш  возраст&quot;</span>
    <span class="n">raw_data</span><span class="p">[</span><span class="n">age_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">age_col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="n">age_col</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

    <span class="n">score_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">col</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Q7&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Q8&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Q9&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="c1"># if a value in scoring col is missing, replace by the mean</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">score_cols</span><span class="p">:</span>
        <span class="n">raw_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>

    <span class="n">free_answer_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Q4.1 Каковы, на ваш взгляд,  сильные и слабые стороны программы? - Сильные стороны&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q4.2 Каковы, на ваш взгляд,  сильные и слабые стороны программы? - Слабые стороны&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q10 Оставьте ваши  пожелания и дополнительные комментарии  по программе&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q10 Оставьте ваши  пожелания и дополнительные комментарии  по программе&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q11.1.O В качестве приглашенного спикера - брендинг, корпфин&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q11.5.O Другое - протагонист кейса&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q13.6.O Другое - Other&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Q14.20.O Другое - Other&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="c1"># set to &quot;No comments&quot; if the answer wasnt provided in cols with free answer</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">free_answer_cols</span><span class="p">:</span>
        <span class="n">raw_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;No comments&quot;</span><span class="p">)</span>

    <span class="c1"># save to stream</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">raw_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">buf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>